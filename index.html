<!-- index.html (vollstÃ¤ndig) -->
<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Ãœberfachliche Kompetenzen</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <header class="topbar">
    <div class="topbar__inner">
      <div>
        <h1>Ãœberfachliche Kompetenzen</h1>
        <div class="subline">
          Digitales Beurteilungsraster Â· ohne Datenspeicherung Â· PDF-Export
        </div>
      </div>
      <div class="topbar__actions">
        <button class="btn btn--ghost" id="btnCopy" type="button">Text kopieren</button>
        <button class="btn btn--ghost" id="btnReset" type="button">ZurÃ¼cksetzen</button>
      </div>
    </div>
  </header>

  <main class="layout">
    <section class="card">
      <h2 class="card__title">Formularkopf</h2>

      <div class="grid grid--4">
        <div class="field">
          <label for="studentName">Name</label>
          <input id="studentName" type="text" placeholder="Vorname Nachname" />
        </div>

        <div class="field">
          <label for="className">Klasse</label>
          <input id="className" type="text" placeholder="z.B. 4a" />
        </div>

        <div class="field">
          <label for="gender">Geschlecht</label>
          <select id="gender">
            <option value="m">m</option>
            <option value="w">w</option>
          </select>
        </div>

        <div class="field">
          <label for="teacherName">Lehrperson</label>
          <input id="teacherName" type="text" placeholder="Name der Lehrperson" />
        </div>
      </div>

      <div class="grid grid--3">
        <div class="field">
          <label for="place">Ort</label>
          <input id="place" type="text" />
        </div>

        <div class="field">
          <label for="date">Datum</label>
          <input id="date" type="date" />
        </div>

        <div class="field field--inline">
          <label class="check">
            <input id="pdfIncludeDetails" type="checkbox" />
            <span>Bewertungskriterien im PDF ausgeben (inkl. Markierungen)</span>
          </label>
        </div>
      </div>
    </section>

    <section class="card">
      <h2 class="card__title">Raster</h2>
      <div id="rasterRoot"></div>
    </section>

    <section class="card">
      <div class="card__titleRow">
        <h2 class="card__title">Text (editierbar)</h2>
        <div class="row">
          <button class="btn btn--ghost" id="btnRegen" type="button">Text neu erzeugen</button>
          <button class="btn btn--ghost" id="btnDictateText" type="button">ðŸŽ¤ Diktat</button>
        </div>
      </div>

      <div class="hint">
        WÃ¶rter in <span class="mod">Farbe</span> sind bewusst â€žStellschraubenâ€œ (z.B. Frequenz/QualitÃ¤t) und lassen sich schnell anpassen.
      </div>

      <div id="reportEditor" class="editor" contenteditable="true" spellcheck="true"></div>

      <div class="split">
        <div>
          <div class="row row--between">
            <h3 class="subhead">ZusÃ¤tzliche Bemerkungen (nur fÃ¼r Text / Copilot, nicht separat im PDF)</h3>
            <button class="btn btn--ghost" id="btnDictateRemarks" type="button">ðŸŽ¤ Diktat</button>
          </div>
          <textarea id="teacherRemarks" class="textarea" rows="4" placeholder="Optional: zusÃ¤tzliche Bemerkungen der Lehrperson (werden in den Text integriert)"></textarea>
        </div>

        <div class="actions">
          <h3 class="subhead">Copilot</h3>
          <button class="btn btn--ghost" id="btnAiCopy" type="button">Text + Prompt kopieren</button>
          <button class="btn btn--ghost" id="btnAiClean" type="button">Nur Text glÃ¤tten</button>
          <button class="btn btn--primary" id="btnAiOpen" type="button">In Copilot bearbeiten</button>

          <div class="mini">
            Hinweis: Die Anleitung Ã¶ffnet sich automatisch, wenn du 3 Sekunden Ã¼ber dem Copilot-Button verweilst.
          </div>
        </div>
      </div>

      <div class="footerActions">
        <button class="btn btn--primary" id="btnPdf" type="button">PDF erstellen</button>
      </div>
    </section>
  </main>

  <!-- Overlay Anleitung (Hover > 3s auf Copilot-Button) -->
  <div id="aiOverlay" class="overlay" aria-hidden="true">
    <div class="overlay__backdrop"></div>
    <div class="overlay__panel" role="dialog" aria-modal="true" aria-label="Copilot Anleitung">
      <div class="overlay__head">
        <div class="overlay__title">Copilot: Text verbessern & zurÃ¼ckkopieren</div>
        <button class="overlay__close" type="button" data-close="copilot">Ã—</button>
      </div>

      <ol class="overlay__steps">
        <li><strong>â€žText + Prompt kopierenâ€œ</strong> drÃ¼cken (oder wurde beim Ã–ffnen schon kopiert).</li>
        <li><strong>Copilot Ã¶ffnen</strong> und den Prompt einfÃ¼gen (Ctrl+V).</li>
        <li>Copilot gibt zwei BlÃ¶cke aus: <strong>AUSWERTUNG</strong> und <strong>KOMMENTAR</strong>.</li>
        <li>Beides wieder hier in den Editor kopieren (du kannst KOMMENTAR am Ende belassen).</li>
        <li>Dann <strong>PDF erstellen</strong>.</li>
      </ol>

      <div class="overlay__actions">
        <button class="btn btn--ghost" id="btnOverlayCopyAgain" type="button">Prompt + Text nochmals kopieren</button>
        <button class="btn btn--primary" id="btnOverlayOpenCopilot" type="button">Copilot Ã¶ffnen</button>
      </div>
    </div>
  </div>

  <!-- PRINT AREA (offscreen) -->
  <div id="printArea" class="printArea printArea--offscreen" aria-hidden="true">
    <!-- Seite 1 -->
    <section class="printPage">
      <div class="printHeader">
        <div class="printTitle">Ãœberfachliche Kompetenzen</div>
        <div id="printHead" class="printMeta"></div>
      </div>

      <div class="printBlockTitle">Primarschule: EinschÃ¤tzung zum Lern-, Arbeits- und Sozialverhalten</div>

      <div class="printTables">
        <div id="printTableArbeits"></div>
        <div id="printTableSozial"></div>
      </div>

      <div class="printSectionTitle">Gesamtbeurteilung</div>
      <div id="printText" class="printText"></div>

      <!-- optional: Details (Kriterienliste) -->
      <div id="printDetailsWrap" class="printDetailsWrap" hidden>
        <div class="printDetailsTitle">Bewertungskriterien (Details)</div>
        <div id="printDetails" class="printDetails"></div>
      </div>
    </section>

    <!-- Seite 2 -->
    <section class="printPage">
      <div class="printHeader">
        <div class="printTitle">Ãœberfachliche Kompetenzen</div>
        <div id="printHead2" class="printMeta"></div>
      </div>

      <div class="printSectionTitle">Bemerkungen der Eltern</div>
      <div class="parentBox">
        <div class="parentLines"></div>
      </div>

      <div class="signatures">
        <div class="sigRow">
          <div class="sigLabel" id="sigTeacherCap">Lehrperson</div>
          <div class="sigLine"></div>
          <div class="sigHint">Unterschrift</div>
        </div>
        <div class="sigRow">
          <div class="sigLabel">Visum Eltern</div>
          <div class="sigLine"></div>
          <div class="sigHint">Datum / Unterschrift</div>
        </div>
      </div>
    </section>
  </div>

  <!-- Vendor (lokal einbinden) -->
  <script src="vendor/html2canvas.min.js"></script>
  <script src="vendor/jspdf.umd.min.js"></script>

  <script src="app.js"></script>
</body>
</html>
